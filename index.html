<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Address Form</title>
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>

    <form id="gform" action="https://docs.google.com/forms/u/0/d/1huiEHRs2odB-Q7Ng15B7OiOTxKvyeaXpF93vLi8xdhA/formResponse" method="POST" target="_self">

        <h1>Les adresses ! ðŸŒŸ</h1>
        <p class="intro">Envoyez nous votre contact pour une surprise postale !</p>
        <p class="intro">Send us your details for a postal surprise!</p>

        <div class="form-group">
            <input name="entry.1573920476" placeholder="PrÃ©nom / Name" required>
        </div>

        <div class="form-group">
            <input name="entry.1883987193" placeholder="Nom / Surname" required>
        </div>

        <div class="form-group">
            <input name="entry.681709445" type="email" placeholder="Courriel / Email" required>
        </div>

        <div class="form-group">
            <label for="consent">J'accepte d'Ãªtre contactÃ© par la famille Canova Schwarz pour des communications et informations concernant leur vie personnelle, professionnelle et leur bien Ãªtre gÃ©nÃ©ral.</label>
            <select name="entry.1269550060" id="consent" required>
                <option value="" disabled selected>Select an option</option>
                <option value="Oui">Oui</option>
                <option value="Non">Non</option>
            </select>
        </div>

        <!-- Visible autocomplete field -->
        <script type="module" src="https://ajax.googleapis.com/ajax/libs/@googlemaps/extended-component-library/0.6.11/index.min.js"></script>
        <gmpx-api-loader key="MAPS_API_KEY" solution-channel="GMP_GE_placepicker_v2">
        </gmpx-api-loader>
        <div id="place-picker-box">
            <label>Votre adresse / Enter your address:</label>
            <div id="place-picker-container">
                <gmpx-place-picker placeholder="Start typing your address..."></gmpx-place-picker>
            </div>
            <button type="button" id="confirm-address">Confirmer l'adresse / Use this address <br><span class="btn-subtext">ou entrer directement dans le champ ci-dessous / or fill below</span></button>
        </div>

        <!-- Address Google Form field -->
        <input name="entry.1707553072" placeholder="Adresse / Address" id="address-hidden"><br>

        <button type="submit" id="submit-btn">Envoyer / Submit âœ¨</button>
    </form>

    <script>
        const placePicker = document.querySelector('gmpx-place-picker');
        const confirmAddressBtn = document.getElementById('confirm-address');
        const hiddenAddressInput = document.getElementById('address-hidden');
        const form = document.getElementById('gform');
        const consentSelect = document.getElementById('consent');
        const submitBtn = document.getElementById('submit-btn');

        confirmAddressBtn.addEventListener('click', () => {
            const place = placePicker.value;

            if (place && place.formattedAddress) {
                hiddenAddressInput.value = place.formattedAddress;
            }
        });

        form.addEventListener('submit', function(e) {
            e.preventDefault(); // prevent default form submission and redirect

            // Create a FormData object from the form
            const formData = new FormData(form);
            const consentValue = consentSelect.value;

            // Send it using fetch
            fetch(form.action, {
                method: 'POST',
                mode: 'no-cors', // Google Forms doesn't return CORS headers
                body: formData
            })
            .then(() => {
                if (consentValue === 'Oui') {
                    alert('Merci ! Ã€ trÃ¨s vite ðŸ£');
                } else if (consentValue === 'Non') {
                    alert('Pas de consentement :( Dommage Fromage ðŸ§€');
                }
                form.reset(); // clear the form
            })
            .catch((error) => {
                console.error('Error submitting form:', error);
                alert('There was a problem submitting the form.');
            });
        });
    </script>

</body>

</html>
