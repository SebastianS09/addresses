<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Address Form</title>

</head>

<body>

    <form id="gform" action="https://docs.google.com/forms/u/0/d/1huiEHRs2odB-Q7Ng15B7OiOTxKvyeaXpF93vLi8xdhA/formResponse" method="POST" target="_self">

        <input name="entry.1573920476" placeholder="Name" required><br>
        <input name="entry.1883987193" placeholder="Surname" required><br>
        <input name="entry.681709445" type="email" placeholder="Email" required><br>
        <input name="entry.1269550060" placeholder="Consent" required><br>

        <!-- Visible autocomplete field -->
        <script type="module" src="https://ajax.googleapis.com/ajax/libs/@googlemaps/extended-component-library/0.6.11/index.min.js"></script>
        <gmpx-api-loader key="MAPS_API_KEY" solution-channel="GMP_GE_placepicker_v2">
        </gmpx-api-loader>
        <div id="place-picker-box">
            <div id="place-picker-container">
                <gmpx-place-picker placeholder="Enter an address"></gmpx-place-picker>
            </div>
            <button type="button" id="confirm-address">
                Use this address
            </button>
        </div>

        <!-- Address Google Form field -->
        <input name="entry.1707553072" id="address-hidden"><br>

        <button type="submit">Submit</button>
    </form>

	<script>
        const picker = document.getElementById("place-picker");
        const confirmBtn = document.getElementById("confirm-address");
        const hiddenAddress = document.getElementById("address-hidden");
        const status = document.getElementById("address-status");

        let selectedPlace = null;
        let addressConfirmed = false;

        picker.addEventListener("gmpx-placechange", (e) => {
            selectedPlace = e.detail.place;
            addressConfirmed = false;
            hiddenAddress.value = "";
            status.textContent = "Address selected, please confirm.";
            status.className = "";
        });

        confirmBtn.addEventListener("click", () => {
            if (!selectedPlace || !selectedPlace.formattedAddress) {
                status.textContent = "Please select a valid address first.";
                status.className = "error";
                return;
            }

            hiddenAddress.value = selectedPlace.formattedAddress;
            addressConfirmed = true;
            status.textContent = "âœ“ Address confirmed";
            status.className = "ok";
        });

        document.getElementById("gform").addEventListener("submit", (e) => {
            if (!addressConfirmed) {
                e.preventDefault();
                status.textContent = "Please confirm your address before submitting.";
                status.className = "error";
            }
        });
    	</script>


</body>

</html>